---
title: SSO React Native
description: Get started building a mobile payment app with ZKsync SSO
---

## Prerequisites

1. An Apple developer account.
1. A registered domain to associate passkeys with.
1. Installed system dependencies for React Native,
  including Node, Watchman, the React Native command line interface, a Ruby version manager, Xcode and CocoaPods.
  On the React Native [environment setup page](https://reactnative.dev/docs/0.70/environment-setup),
  select "React Native CLI Quickstart".
  Under "Target OS" select "iOS".
1. An iPhone with Developer Mode enabled and that is added to your Apple Developer account.

## What we are building

In this tutorial we will build an iOS payment app similar to Venmo.
You will be able to:

  1. Create a new wallet using ZKsync SSO.
  1. Send ETH to other wallets.
  1. Sign transactions with FaceID.
  1. See transactions from your friends list.

The app does not have any backend or storage implemented.
The friends list is hardcoded,
and the transactions list only shows real-time transactions while the app is running,
as they are not stored anywhere.

## Setup

Clone the template project

```bash
git clone ...
```

Open the workspace at `project/ios/ZKsyncSSOPay.xcworkspace` in Xcode.
Select the project target in the left-side menu.
Under "Signing and Capabilities",
add your team, create a unique bundle identifier based on your domain,
and select "Automatically Manage Signing".

Make a new App ID on your Apple Developer account using the unique bundle identifier you created.
Make sure to select Associated Domains while creating the App ID.
This is required to use passkeys.

Add the App ID to a associated domain file, and deploy to your domain.

In Xcode under "Signing and Capabilities",
click on "+ Capability" and add "Associated Domains".
and add your domain (e.g. `webcredentials:auth-test.zksync.dev`).

At this point, your domain points to your App ID, the App ID points to your domain.

## Adding ZKsync SSO

Right now the app is just missing ZKsync SSO integration.
Let's add that:

Install the package:

```bash
npx expo install react-native-zksync-sso
```

### Configuration File

ZKsync SSO contracts from ZKsync Era Sepolia testnet.
If you wanted to use a different deployment of the SSO contracts,
this is where you would configure those values.

There is also a private key that represents the wallet that will deploy accounts.
(Does this wallet need funds? Is it used for normal `registerAccount`?)

### `AccountContext`

The `AccountContext.ts` file manages the account details for the user via a context provider.
It lets us access the account details in other components.

The `AccountProvider` is used in the `_layout.tsx` file to wrap our entire application, so the account details are always available.

### `index.tsx`

Our index page is the entry file for our app.
This is where we will define the RpId for the passkeys.

#### RpId

The RpId is short for the relaying party ID,
a key component of passkeys.
This value ties the passkey created to your domain.

You can use the same domain for different applications,
so the same passkey works on all of the applications.

Modify the input value for the `sdk.utils.createRpId` function in the `index.tsx` file
so it matches your domain.
For iOS, you only need to modify the first input value.
The second value is only used for Android.

```tsx
(code)
```

### `MainView` component

The `MainView.tsx` component manages whether to show the user the `LoggedOutView` or redirect to the tabs in `(account)/(tabs)'`.

### `LoggedOutView` component

There are two methods available to create a new wallet and passkey: `registerAccount` and `registerAccountWithUniqueId`.

- `registerAccount` creates a random wallet address.
- `registerAccountWithUniqueId` creates a deterministic wallet address based on the deploy wallet private key and the user ID.

For web3 native applications, generally `registerAccount` is recommended.
In this case, only the account address must be stored somewhere.
The account address cannot be derived in any way.

For web2 applications that already have a username or email used to login,
`registerAccountWithUniqueId` can be used to create addresses based on that account info.
Because the method also relies on a private key from the ZKsync SSO config,
this method should be called from a private backend server.
In this case, the address can be derived from the userID.

For this example, however, we will be using `registerAccountWithUniqueId` without a backend server to demonstrate how that works.
However, note that because both values that determine the address are hardcoded here
(the private key in the config and the account user ID),
**this will generate the same address for all users**.
Do not use this implementation in production!

For testing purposes,
**change the name and user ID** passed in to the `LoggedOutView` component from the `MainView` component.
This way your account is unlikely to collide with another
user testing this demo.

### `AccountCreationView` and `PasskeyCreationView` components

The `AccountCreationView` component is mostly a view wrapper around the `PasskeyCreationView` component.
It displays the user name and user ID used for account creation.

The `PasskeyCreationView` component is where the passkey is generated.
It calls the `createPasskey` in the `utils/account.ts` file.

This function creates a new passkey and generates a new wallet in three steps:

1. Generates a random challenge (i.e. message) for the passkey to sign.
1. Prepares the RpId for the passkey to be associated with.
1. Registers the passkey and account with `registerAccountWithUniqueId`.

The account name will be used to identify the passkey.
When a user is prompted to sign a transaction,
they should select the passkey with the same name.

### Account Client

The account client is what we will use to send transactions.

Add a new folder in the `utils` folder called `authenticate`.
Create a new file called `accountClient.ts` in the `utils/authenticate` folder.

Paste the code below:

```tsx
(code)
```

The `prepareSendTransaction` function just prepares the full transaction details of a transaction in case you want to display those.

The `sendTransaction` function sends transactions and awaits for them to be confirmed.

Create a new file called `authenticator.ts` in the `utils/authenticate` folder.

Paste the code below:

```tsx
(code)
```

### Mock Data

In the `utils/mockData.ts` file is used to populate the friends list.
Edit at least one of these addresses with an address that you control.

### Send Transaction

Add a file called `sendETH.ts` in the `utils` folder.
Paste the code below:

```tsx
(code)
```

## Running the app

Make sure you have the local Network permission on for the dev build.
iOS 14+ blocks all LAN traffic until you approve it once.
Settings ▸ Privacy & Security ▸ Local Network → enable the switch for your dev‑build app.

To work with passkeys in the ios simulator,
click on "Features" ▸ "FaceID", and select "Enrolled".
To sign with FaceID, select "Features" ▸ "Matching Face".
